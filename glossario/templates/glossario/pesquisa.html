{% extends 'glossario/base.html' %}
{% block head %}
{{ block.super }}
{{ formSinais.media }}
{% load staticfiles %}
<title>{% block title %}Pesquisa {{ glossario.nome }} - Glossário Letras Libras {% endblock %}</title>
{% endblock %}
{% block body %}


<div class="area-para-footer row container">
  <div class="col l2 hide-on-med-and-down">
    <!-- Filtros -->
    <section>
      <h5>Filtros</h5>
      <ul class="collapsible">      

      <!-- Glossários -->
        <li class="active">
          <div class="collapsible-header"><h6>Glossários</h6><h6 class="material-icons expand_less">expand_less</h6></div>
          <div class="collapsible-body">
            <form action="{% url 'pesquisa' %}" method="GET">
              {% for glossario in glossarios %}
                <p>
                  <label>
                    <input value="{{ glossario.id }}" class="with-gap escolhaGlossario"
                    id="{{ glossario.id }}" type="radio"/>
                    <span class="dark-blue-text">{{glossario.nome}}</span>
                  </label>
                </p>
                {% endfor %}
            </form>
          </div>
        </li>

        <!-- Areas -->
        <li class="active">
          <div class="collapsible-header"><h6>Áreas</h6><h6 class="material-icons expand_less">expand_less</h6></div>
          <div class="collapsible-body">
            <form action="{% url 'pesquisa' %}" method="GET">
              {% for area in areas %}
              <div>
                <p>
                  <label>
                    <input value="{{ area.id }}" class="with-gap escolhaArea"
                    id="area_{{ area.id }}" type="radio"/>
                    <span class="dark-blue-text">{{area.nome}}</span>
                  </label>
                </p>
              </div>
              {% endfor %}
            </form>
          </div>
        </li>

        <!-- Letras -->
        <li class="active">
          <div class="collapsible-header"><h6>Letra Inicial</h6><h6 class="material-icons expand_less">expand_less</h6></div>
          <div class="collapsible-body">
            <form id="formLetra" action="{% url 'pesquisa' %}" method="GET">
              {% for letter in alfabeto %}
              <div>
                <p>
                  <label>
                    <input name="letra_inicial" value="{{ letter }}" class="with-gap escolhaLetra"
                    id="letra_{{ letter }}" class="with-gap" type="radio"/>
                    <span class="dark-blue-text">{{letter}}</span>
                  </label>
                </p>
              </div>
              {% endfor %}
            </form>
          </div>
        </li>
      </ul>

    </section>
  </div>
  <div class="col l10 s12">
    <div>
      {% if sinais_page %}
      {% include 'glossario/blockPesquisaList.html' %}
      {% else %}
        {% if glossario %}
        <div>
          {% if glossario.imagem %}
          <img class="circle left glossario-icon" src="{{ glossario.imagem.url }}" />
          {% endif %}
          <p class="flow-text center nenhumSinal">
            Nenhum sinal encontrado em
            <a href="{% url 'glossario' glossario=glossario.slugify %}" style="color:darkblue">{{ glossario.nome }}</a>
            :
          </p>
        </div>
        {% elif area %}
        <div>
          <p class="flow-text center nenhumSinal">
            Nenhum sinal encontrado em {{ area }} :
          </p>
        </div>
        {% else %}
        <p class="flow-text center nenhumSinal">Nenhum sinal encontrado</p>
        {% endif %}
      {% endif %}
    </div>

    {% if sinais_page.has_other_pages %}
    <ul class="pagination center">
      {% for n in sinais_page.paginator.page_range %}
      {{ sinais_page.page}}
      {% if sinais_page.number|add:'-3' == n %}
      <!-- Primeira Pagina -->
      <li class="waves-effect">
        <a href="?page=1">1</a>
        {% if n != 1 %}
      <li class="disabled"><a>&#8943;</a></li>
      {% endif %}
      {% elif sinais_page.number == n %}
      <!-- Pagina atual  -->
      <li class="active blue"><a>{{ n }}</a></li>
      {% elif sinais_page.number|add:'-3' < n and n < sinais_page.number|add:'3' %}
      <!-- Paginas perto da pagina atual -->
      <li class="waves-effect">
        <a href="?page={{ n }}">{{ n }}</a>
      </li>
      {% elif sinais_page.number|add:'3' == n %}
      <!-- Ultima pagina -->
      {% if n != sinais_page.paginator.num_pages %}
      <li class="disabled"><a>&#8943;</a></li>
      {% endif %}
      <li class="waves-effect">
        <a href="?page={{ sinais_page.paginator.num_pages }}">{{ sinais_page.paginator.num_pages }}</a>
      </li>
      {% endif %}
      {% endfor %}
    </ul>
    {% endif %}
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function(){
    $(".collapsible").collapsible({ accordion: false });

    var valor_glossario = "{{ glossario.id }}";
    var valor_area = "{{ area }}";
    var valor_letra = "{{ letra_inicial }}";

    if(valor_letra){
      $('#letra_{{ letra_inicial }}').prop("checked", true);
    }
    if(valor_glossario){
      $('.escolhaGlossario#{{ glossario.id }}').prop("checked", true);
      $('#id_glossario').val(valor_glossario);
    }
    if(valor_area){
      $('#area_{{ area.id }}').prop("checked", true);
    }

    $('.escolhaGlossario').click(function(){
      // alert(this.id)
      if(valor_glossario == this.id){
        $('#id_glossario').val("");
        $('#formSinais').submit();
      } else {
        var escolhaGlossario = $(this).attr('value');
        $('#id_glossario').val(escolhaGlossario);
        $('#formSinais').submit();
      }
    });

    $('.escolhaArea').click(function(){
      var escolhaArea = $(this).attr('value');
      $('#id_area').val(escolhaArea);
      $('#formSinais').submit();
    });

    $('.escolhaLetra').click(function(){
      // var escolhaLetra = $(this).attr('value');
      // $('#id_glossario').val(escolhaGlossario);
      // alert(this);
      // this.submit();
      $('#formLetra').submit();
    });
    
  });
</script>
{% endblock %}
